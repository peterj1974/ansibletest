---
- name: Create a file and write hostname to it
  block:
    - name: Touch file  
      file:
        path: /tmp/hostname
        state: touch
    
    - name: Write hostname to file
      lineinfile:
        path: /tmp/hostname
        line: "{{ ansible_hostname }}"



#- name: Get first IP address of host in the morph group. This will be our SOT node for RabbitMQ clustering
#  set_fact:
#    rabbitmq_sot: "{{ groups['morph'] | map('extract', hostvars, ['ansible_eth0', 'ipv4', 'address']) | list | sort | first}}"
#
#- debug:
#    var: rabbitmq_sot
#
#- name: Get hostname of the SOT node
#  set_fact:
#    rabbitmq_sot_name: "{{ ansible_hostname }}"
#  when: ansible_eth0.ipv4.address == "{{ rabbitmq_sot }}"
#
