---
- hosts: all
  gather_facts: yes
  become: yes
  become_user: root
  become_method: sudo
  vars:
    ips: "{{ groups['db'] | map('extract', hostvars, ['ansible_default_ipv4', 'address']) | sort | list }}"
  tasks:     
    - name: Set IP facts
      set_fact:
        ip1: "{{ ips[0] }}"
        ip2: "{{ ips[1] }}"
        ip3: "{{ ips[2] }}"